<!DOCTYPE html>
<html lang="ru">
    <head>
        <title>CSS 3</title>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8"/>
        <link rel="stylesheet" href="css/index.css">
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.7.0.js"></script>
    </head>
    <body>
            
            <div class="data">
                
            </div>
            <div>
                <input type="button" value="Продолжить вводить доски" onclick="prodol()">
            </div>
            <script>
            var mass=[[0]];
            var add__data=document.getElementsByClassName('data');
            
            function prodol()
            {
                add__data[0].removeChild(add__data[0].lastChild);
                if (mass.length==0){
                    
                    mass=[[0]];
                }
                vvod();

            }
            function as(){
                if (mass[0][0]==0){
                        return 1
                    }
                else{
                    return mass.length+1
                }
            }
            function vvod(){
                    while (1==1){
                    var a=prompt('Введите размеры '+(as())+ ' доски "50x200x6 (8 штук)" \n в формате  "50 200 6 8" (мм мм м шт) \n Для отмены нажмите кнопку отмена или напишете отмена \n Объем предыдущей доски '+mass[mass.length-1][0]+' м3\n Общий объем '+summa()+' м3');
                    if (a==null || a==='Отмена'|| a==='отмена'){
                        podschet();
                        break;
                    }
                    a=a.split(/[ ,/\*--$&@]+/);
                    if (a.length==4 && Number.isFinite((+a[0])) && Number.isFinite((+a[1])) && Number.isFinite((+a[2])) && Number.isFinite((+a[3]))){
                    var s=a[0]*a[1]*a[2]*a[3]/1000000;
                    let aaa=document.createElement('div');
                    $(aaa).append('<span>Доска № </span>'+(as())+'<span>. Размеры "</span>'+a[0]+' '+a[1]+' '+a[2]+' '+a[3]+'". '+'<span style="color:blue">Объем доски '+s+'</span>'+' м<sup>3</sup>  '+'<input type="button" value="Изменить" onclick="izm('+(as()-1)+')">  <input type="button" value="Удалить" onclick="delone('+(as()-1)+')">');
                    add__data[0].appendChild(aaa);
                    if (mass[0][0]==0){
                        mass=[]
                    }
                    mass[mass.length]=[s,a[0],a[1],a[2],a[3]]
                    }
                    else if (a.length<4 || a.length>4) {
                     alert('Вы ввели недостаточно данных, не хватает переменных или их много');}
                    else{
                         alert('c данными что-то не то, \n возможно вы ввели буквы или лишние символы');
                     }
                }

            }
            function delall(){
                while (add__data[0].hasChildNodes()) {  
                    add__data[0].removeChild(add__data[0].lastChild);
}
            }
            function vstav(){
                for (var i=0; i<mass.length;i++){
                    let aaa=document.createElement('div');
                    $(aaa).append('<span>Доска № </span>'+(i+1)+'<span>. Размеры "</span>'+mass[i][1]+' '+mass[i][2]+' '+mass[i][3]+' '+mass[i][4]+'". '+'<span style="color:blue">Объем доски '+mass[i][0]+'</span>'+' м<sup>3</sup>  '+'<input type="button" value="Изменить" onclick="izm('+i+')">   <input type="button" value="Удалить" onclick="delone('+i+')">');
                    add__data[0].appendChild(aaa);
                }
            }
            function izm(per){
                while (1==1){
                    var a=prompt('Введите размеры '+(per+1)+ ' доски "50x200x6 (8 штук)" \n в формате  "50 200 6 8" (мм мм м шт) \n Для отмены нажмите кнопку отмена или напишете отмена \n Общий объем '+summa()+' м3',mass[per][1]+','+mass[per][2]+','+mass[per][3]+','+mass[per][4]);
                    if (a==null || a==='Отмена'|| a==='отмена'){
                        break;
                    }
                    a=a.split(/[ ,/\*--$&@]+/);
                    if (a.length==4 && Number.isFinite((+a[0])) && Number.isFinite((+a[1])) && Number.isFinite((+a[2])) && Number.isFinite((+a[3]))){
                    var s=a[0]*a[1]*a[2]*a[3]/1000000;
                    mass[per]=[s,a[0],a[1],a[2],a[3]];
                    break;
                    }
                    else if (a.length<4 || a.length>4) {
                     alert('Вы ввели недостаточно данных, не хватает переменных или их много');}
                    else{
                         alert('c данными что-то не то, \n возможно вы ввели буквы или лишние символы');
                     }
                }
                delall();
                vstav();
                podschet();
            }
            function delone(per){
                mass.splice(per, 1);
                delall();
                vstav();
                podschet();
            }
            function podschet(){
                let aa=document.createElement('div');
                var summ=0;
                for (let i=0; i < mass.length; i++) {
                summ+=mass[i][0];
            }   
                summ=Math.round(summ * 1000)/1000;
                 aa.innerHTML='<hr> Общий Объем досок '+ summ+' м<sup>3</sup>  ';
                 add__data[0].appendChild(aa);
            }
            function summa(){
                var summ=0;
                for (let i=0; i < mass.length; i++) {
                summ += mass[i][0];}
                summ=Math.round(summ * 1000)/1000;
                return summ;
            }
            vvod();


















                // var num=1;
                // var summ=0;
                // var cl=document.getElementsByClassName('data');
                // console.log(cl[0]);
                // var s=0
                // while (1==1){
                //     var a=prompt('Введите размеры '+num+ ' доски "50x200x6 (8 штук)" \n в формате  "50 200 6 8" (мм мм м шт) \n Для отмены нажмите кнопку отмена или напишете отмена \n Объем предыдущей доски '+s+'\n Общий объем '+summ);
        
                //     if (a==null || a==='Отмена'|| a==='отмена'){
                //         let aa=document.createElement('div');
                //         aa.innerHTML='Общий Объем досок '+ summ;
                //         cl[0].appendChild(aa);
                //         break;
                //     }
            
                //     a=a.split(/[ ,]+/);
                //     if (a.length==4 && Number.isFinite((+a[0])) && Number.isFinite((+a[1])) && Number.isFinite((+a[2])) && Number.isFinite((+a[3]))){
                //         var s=a[0]*a[1]*a[2]*a[3]/1000000;
                //         summ=summ+s;
                //         let aaa=document.createElement('div');
                //         aaa.innerHTML='Доска № '+num+'. Размеры "'+a[0]+' '+a[1]+' '+a[2]+' '+a[3]+'". Объем доски '+ s;
                //         console.log(aaa);
                        
                //         cl[0].appendChild(aaa);
                        
                //         num++;
                        
                //     }
                //     else if (a.length<4 || a.length>4) {
                //         alert('Вы ввели недостаточно данных, не хватает переменных или их много');

                //     }
                //     else{
                //         alert('c данными что-то не то');
                //     }
                // }
            </script>
    </body>
</html>    
